(function($){window.$$=function(id){return document.getElementById(id)};var app={includePath:"",include:function(file){var files=typeof file==="string"?[file]:file;for(var i=0;i<files.length;i++){var name=files[i].replace(/^s|s$/g,"");var att=name.split(".");var ext=att[att.length-1].toLowerCase();var isCSS=ext==="css";var tag=isCSS?"link":"script";var attr=isCSS?" type='text/css' rel='stylesheet' ":" language='javascript' type='text/javascript' ";var link=(isCSS?"href":"src")+"='"+this.includePath+name+"'";if($(tag+"["+link+"]").length===0){document.write("<"+tag+attr+link+"></"+tag+">")}}},getCurrentJsPath:function(){var js=document.scripts,path=js[js.length-1].src;return path.substring(0,path.lastIndexOf("/")+1)}};var form=function(){this.data=null};form.prototype.submit=function(form,callback){var formData=$(form).serializeArray(),self=this;app.http.load(form.action,formData,form.method,function(data){data.formData=formData;self.handle(data,callback)})};form.prototype.bind=function(){var self=this;$("form[data-ajax]:not([data-bound])").data("bound",true).each(function(){var $this=$(this),callback_string=$this.data("callback");callback=callback_string?eval(callback_string):null;$this.submit(function(){self.submit(this,callback);return false})})};form.prototype.handle=function(data,callback){if(typeof(callback)==="function"){callback.call(null,data);return}if(data.status===1){app.msg.success(data.info,1000,function(){data.url?location.href=data.url:location.reload()})}else{app.msg.error(data.info,3000,function(){if(data.url){location.href=data.url}})}};var msg=function(){this.counter=0;this.queue={loading:[],msg:[]}};msg.prototype.pageLoading=function(close){if(close){$("#_page-loading").remove()}else{$obj=$('<div id="_page-loading" class="loader loader-curcirsquare"></div>');$obj.appendTo("body")}};msg.prototype.popLoading=function(txt){txt=txt?'<div class="load-word4">'+txt+"</div>":"";var key="loading-"+this.counter,html='<div id="'+key+'" class="load-con2 pop-loading"><div class="load5"><div class="loader"></div></div><div class="load-word3">UPINKJI</div>'+txt+"</div>";$(html).appendTo("body");this.queue.loading[this.counter]=key;return this.counter++};msg.prototype.popLoadingClose=function(index){var key=this.deleteQueue(index);if(key===null){return}$("#"+key).hide(0,function(){$(this).remove()})};msg.prototype.deleteQueue=function(index){var key=null;if(index){key=this.queue.loading[index];this.queue.loading[index]=null}else{for(var i in this.queue.loading){if(this.queue.loading[i]!==null){key=this.queue.loading[i];this.queue.loading[i]=null;break}}}return key};msg.prototype.loadingCircle=function(msg,delay,callback){msg=msg||"加载中";if(typeof(delay)==="function"){callback=delay;delay=null}var div=document.createElement("div");div.className="loading";div.id="_l-"+this.counter;div.innerHTML='<div class="loading-rotate"></div><p class="loading-word">'+msg+"</p>";document.body.appendChild(div);delay&&setTimeout(delay,function(){div.parentNode.removeChild(div);typeof(callback)==="function"&&callback()});return this.counter++};msg.prototype.loadingCircleClose=function(id){var obj=$$("_l-"+id);if(obj!==null){obj.parentNode.removeChild(obj);return true}return false};msg.prototype.loading=function(msg,delay){if(msg===true){this.loadingClose()}else{msg=msg||"加载中";var html='<div id="_loading" class="load-con animation_show"><div class="load4"><div class="loader"></div></div><div class="load-word1">UPINKJI</div><div class="load-word2">'+msg+"</div></div>";$(html).hide().appendTo("body").show();delay&&this.loadingClose(delay)}};msg.prototype.loadingClose=function(delay,callback){setTimeout(function(){$("#_loading").hide(0,function(){$(this).remove()});callback&&callback()},delay)};msg.prototype.toast=function(msg,delay,callback){var div=document.createElement("div");div.setAttribute("align","center");div.setAttribute("style","position:fixed;bottom:20px;left:0;right:0;color:#fff;text-align:center;display:none;");div.innerHTML='<div style="padding:8px;font-size:12px;background:rgba(0,0,0,.6);display:inline-block">'+msg+"</div>";document.body.appendChild(div);delay=delay||2000;div.fadeIn(function(){setTimeout(function(){div.fadeOut(function(){div.parentNode.removeChild(div);typeof(callback)==="function"&&callback()})},delay)})};msg.prototype.alert=function(msg,callback){var div=document.createElement("div");div.className="mask animation_show";div.innerHTML='<div class="conf"><p>'+msg+'</p><a class="true">确定</a>';div.onclick=function(e){var tag=e.target||e.srcElement;if(tag.className==="true"){typeof callback==="function"&&callback();div.parentNode.removeChild(div)}};document.body.appendChild(div);div.style.display="block"};msg.prototype.confirm=function(msg,ok,cancel){msg=msg||"";var obj=document.createElement("div"),html='<div class="conf"><p>'+msg+'</p><div class="conf-con clearfix"><a class="no float-l">取消</a><a class="ok float-l">确定</a></div></div>';obj.className="mask animation_show";obj.innerHTML=html;obj.onclick=function(e){var tag=e.target||e.srcElement;if(tag.className==="ok float-l"){typeof ok==="function"&&ok();obj.parentNode.removeChild(obj)}else{if(tag.className==="no float-l"){typeof cancel==="function"&&cancel();obj.parentNode.removeChild(obj)}}};document.body.appendChild(obj);obj.style.display="block"};msg.prototype.show=function(msg,type,delay,callback){var self=this;this.close(0,function(){delay=delay||2000;var icon="",css="";switch(type){case 0:icon="&#xe62f;";css="su-color-e";break;case 1:icon="&#xe62e;";css="su-color-s";break;case 2:icon="&#xe629;";css="su-color-w"}var div=document.createElement("div");div.id="_msg";div.className="load-con animation_show";div.innerHTML='<div class="load-img"><i class="iconfont su-font '+css+'">'+icon+'</i></div><div class="load-word">'+msg+"</div>";document.body.appendChild(div);self.close(delay,callback)})};msg.prototype.success=function(msg,delay,callback){msg=msg||"操作成功";this.show(msg,1,delay,callback)};msg.prototype.warning=function(msg,delay,callback){msg=msg||"警告";this.show(msg,2,delay,callback)};msg.prototype.error=function(msg,delay,callback){msg=msg||"发生错误";this.show(msg,0,delay,callback)};msg.prototype.close=function(delay,callback){var div=document.getElementById("_msg");setTimeout(function(){if(div){div.className=div.className.replace(/(^| )animation_show($| )/,"")+" animation_hide";setTimeout(function(){div.style.display="none";setTimeout(function(){div.parentNode.removeChild(div);callback&&callback()},400)},400)}else{callback&&callback()}},delay)};var img=function(attr){this.attr=attr||"data-url"};img.prototype.load=function(attr,callback){var self=this;if(typeof(attr)==="function"){callback=attr;attr=null}if(typeof(attr)==="string"){self.attr=attr}return $("img["+self.attr+"]:not([bound])").attr("bound",true).each(function(){if(!this.src){this.src="data:image/png;base64,R0lGODlhAQABAJEAAAAAAP///////wAAACH5BAEHAAIALAAAAAABAAEAAAICVAEAOw=="}}).scrollLoading({attr:self.attr,callback:function(){this.removeAttribute(self.attr);typeof(callback)==="function"&&callback()}})};var cookie=function(){};cookie.prototype.get=function(name){if(document.cookie.length>0){var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");if(arr=document.cookie.match(reg)){return unescape(arr[2])}}return null};cookie.prototype.set=function(name,value,expiredays,path){var cookieStr=name+"="+escape(value);if(path){cookieStr+=";path="+path}if(expiredays){var exdate=new Date();exdate.setDate(exdate.getDate()+expiredays);cookieStr+=";expires="+exdate.toGMTString()}document.cookie=cookieStr;return value};cookie.prototype.del=function(name,path){this.set(name,"",-1,path)};var request=function(){};request.prototype.get=function(name){if(location.search.length>0){var arr,reg=new RegExp("(\\?|&)"+name+"=([^&]*)(&|$)");if(arr=location.search.match(reg)){return decodeURIComponent(arr[2])}}return null};var http=function(){this.data=null};http.prototype.get=function(url,data,callback){return this.load(url,data,"get",callback)};http.prototype.post=function(url,data,callback){return this.load(url,data,"post",callback)};http.prototype.load=function(url,data,type,callback){if(typeof(data)==="function"){callback=data;data=null}var opt={url:url,data:data,type:type||"get",success:function(d){if(typeof(callback)==="function"){callback.apply(null,arguments)}else{this.data=d}console.log(d)},error:function(){if(typeof(callback)==="function"){callback.apply(null,arguments)}else{this.data=null}console.log(arguments)}};if(typeof(callback)==="function"){var key;opt.beforeSend=function(){console.log("加载中...");key=app.msg.popLoading()};opt.complete=function(){console.log("加载完毕");app.msg.popLoadingClose(key)}}return $.ajax(opt)};app.img=new img();app.http=new http();app.msg=new msg();app.form=new form();app.cookie=new cookie();app.request=new request();app.root=app.getCurrentJsPath()+"../../";app.pattern={get:function(key){switch(key){case"phone":return/^1[3|4|5|7|8]\d{9}$/}}};app.vcodeTip=function(btn,sec,tip){tip=tip||"秒后可重新获取";var defaultValue=btn.defaultValue,cursor=btn.style.cursor;btn.value=sec+tip;btn.setAttribute("disabled",true);btn.style.cursor="not-allowed";var resend=setInterval(function(){if(--sec>0){btn.value=sec+tip;app.cookie.set("captcha",sec)}else{clearInterval(resend);app.cookie.del("captcha");btn.value=defaultValue;btn.removeAttribute("disabled",true);btn.style.cursor=cursor}},1000);return resend};window.app=app;window.onload=function(){app.form.bind()}})(jQuery);HTMLElement.prototype.fadeOut=function(d){var c=this,b=1;c.style.opacity=b;c.style.display="block";var a=setInterval(function(){b-=0.01;c.style.opacity=b;if(b<=0){clearInterval(a);c.style.display="none";typeof(d)==="function"&&d()}},10)};HTMLElement.prototype.fadeIn=function(d){var c=this,b=0;c.style.opacity=b;c.style.display="block";var a=setInterval(function(){b+=0.01;c.style.opacity=b;if(b>=1){clearInterval(a);typeof(d)==="function"&&d()}},10)};var Frame=function(){this.url=null;this.iframe=document.createElement("iframe");this.iframe.name="if1";this.iframe.setAttribute("style","border:0;width:100%;height:100%");var a=this;this.iframe.onload=function(){a.container.style.background="#fff";a.show();app.msg.loadingCircleClose(a.index)};this.container=document.createElement("div");this.container.setAttribute("style","position:fixed;left:0;top:0;right:0;bottom:0;z-index:9999;display:none;-webkit-overflow-scrolling:touch;");this.container.appendChild(this.iframe)};Frame.prototype.setUrl=function(a){this.url=a;this.iframe.src=this.url;return this};Frame.prototype.show=function(){this.container.style.display="block";this.lockScroll();return this};Frame.prototype.hide=function(){this.container.style.display="none";this.unlockScroll();return this};Frame.prototype.open=function(a){if(a){this.setUrl(a)}document.body.appendChild(this.container);this.container.style.background="transparent";this.lockScroll();this.index=app.msg.loadingCircle();return this};Frame.prototype.close=function(){this.container.parentNode.removeChild(this.container);this.unlockScroll();return this};Frame.prototype.stopTouchmove=function(a){a.preventDefault()};Frame.prototype.lockScroll=function(){document.body.style.overflow="hidden";document.documentElement.style.overflow="hidden"};Frame.prototype.unlockScroll=function(){document.body.style.overflow="auto";document.documentElement.style.overflow="auto"};Frame.prototype.reload=function(){this.index=app.msg.loadingCircle();this.iframe.contentWindow.location.reload()};